# HG changeset patch
# User Mike Hommey <mh+mozilla@glandium.org>
# Date 1404188948 -32400
#      Tue Jul 01 13:29:08 2014 +0900
# Node ID 35a932e65b5fd4f2734457dd36586954a54b9733
# Parent  286b6cb59c3e62aafc0f2e38384e230db4764eb8
Bug 1031267 - Fix system cairo builds after bug 1027763

diff --git a/gfx/2d/DrawTargetCairo.cpp b/gfx/2d/DrawTargetCairo.cpp
--- a/gfx/2d/DrawTargetCairo.cpp
+++ b/gfx/2d/DrawTargetCairo.cpp
@@ -408,19 +408,23 @@ DrawTargetCairo::GetType() const
     case CAIRO_SURFACE_TYPE_WIN32:
     case CAIRO_SURFACE_TYPE_BEOS:
     case CAIRO_SURFACE_TYPE_OS2:
     case CAIRO_SURFACE_TYPE_QUARTZ_IMAGE:
     case CAIRO_SURFACE_TYPE_SCRIPT:
     case CAIRO_SURFACE_TYPE_RECORDING:
     case CAIRO_SURFACE_TYPE_DRM:
     case CAIRO_SURFACE_TYPE_SUBSURFACE:
+#ifdef CAIRO_HAS_D2D_SURFACE
     case CAIRO_SURFACE_TYPE_D2D:
+#endif
     case CAIRO_SURFACE_TYPE_TEE: // included to silence warning about unhandled enum value
       return DrawTargetType::SOFTWARE_RASTER;
+    default:
+      MOZ_CRASH("Unsupported cairo surface type");
     }
   }
   MOZ_ASSERT(false, "Could not determine DrawTargetType for DrawTargetCairo");
   return DrawTargetType::SOFTWARE_RASTER;
 }
 
 IntSize
 DrawTargetCairo::GetSize()
